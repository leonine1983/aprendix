{% extends "modulo_professor/base.html" %}

{% block main %}  


{% if mural == "notas" %}
<style>
  @media print {
    /* Oculta todo o conte√∫do da p√°gina visualmente */
    body * {
      visibility: hidden;
    }
    h1{font-size: 1.5rem;}

    /* Torna vis√≠vel apenas a .imprimir */
    .imprimir, .imprimir * {
      visibility: visible;
    }

    /* Posiciona a .imprimir como o √∫nico elemento da p√°gina */
    .imprimir {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      padding: 0px;     

      background: white !important;
    }

    /* Remove bot√µes e a√ß√µes de impress√£o */
    .imprimir a.btn, .imprimir .btn, .imprimir .d-print-none , .ocultar{
      display: none !important;
    }

    /* Mant√©m o estilo da tabela */
    table.table {
      width: 100% !important;
      border-collapse: collapse;
    }

    table th, table td {
      border: 1px solid #ccc;
      padding: 6px;
    }

    .text-danger {
      color: red !important;
    }

    .text-primary {
      color: #0d6efd !important;
    }

    .fw-bolder {
      font-weight: bolder;
    }

    .alert {
      background-color: #f8f9fa !important;
      border: 1px solid #dee2e6;
      color: black !important;
    }

    table, tr, td, th {
      page-break-inside: avoid !important;
    }
  }
</style>





<!-- Bot√£o imprimir -->
<div class="text-end my-3 d-print-none mt-5">
  <button onclick="window.print()" class="btn btn-primary mt-4">
    üñ®Ô∏è Imprimir
  </button>
</div>

<div  class='imprimir bg-light rounded-3 shadow '>
  <div class="p-2 shadow shadown-sm ">
    <section class='d-flex '><h1>{{alunos.0.turma}}</h1> | {{alunos|length}} alunos <span class="mx-3 pt-1 small text-uppercasec"  ><strong> Composi√ß√£o de NOTAS da turma | {{request.session.escola.sigla_escola}}  </strong></span></section>
    <section class='fs-3 mx-5 text-center '> <strong>{{trimestre_choice}}</strong> ({{grade}}) </section>
    <section class='fs-3 mx-5 text-center '> </section>
  </div>
  <div class="table-responsive-md p-1">
      <div class="alert alert-info" role="alert">
        <h5 class="alert-heading">üí° Como √© calculada a nota final do aluno?</h5>
        <p>A <strong>nota final</strong> √© calculada automaticamente com base nos seguintes pesos atribu√≠dos a cada componente da avalia√ß√£o:</p>
        <ul>
          <li><strong>Prova</strong>: 50% da nota final</li>
          <li><strong>Trabalho</strong>: 20% da nota final</li>
          <li><strong>Participa√ß√£o</strong> em aula: 15% da nota final</li>
          <li><strong>Tarefas</strong> (atividades complementares): 15% da nota final</li>
        </ul>
        <p>A f√≥rmula usada √©:</p>
        <pre><code>nota_final = (prova √ó 0.5) + (trabalho √ó 0.2) + (participa√ß√£o √ó 0.15) + (tarefas √ó 0.15)</code></pre>
        <p><strong>Importante:</strong> Se o aluno n√£o tiver nota em algum dos campos, ser√° atribu√≠do <strong>zero</strong> automaticamente para que o c√°lculo da nota final possa ser realizado corretamente.</p>
      </div>  
      <table class="table table-striped">
          <thead>
            <tr>
              <th scope="col" class="ocultar">#</th>
              <th scope="col">Nome do aluno</th>
              <th scope="col">Prova (50%)</th>
              <th scope="col">Trabalho (20%)</th>
              <th scope="col">Participa√ß√£o (15%)</th>
              <th scope="col">Tarefas (15%)</th>
              <th scope="col">Nota Final</th>
              <th scope="col" class="ocultar">Anota√ß√£o</th>
              <th scope="col" class="ocultar">A√ß√£o</th>
              
            </tr>
          </thead>
          <tbody>
            {% for a in alunos %}
              <tr>
                  <td scope="row" class="ocultar">{{ forloop.count }}</td>
                  <td class="small">{{ a }}</td>
                  {% for c in a.compoeNotaAlunos_related.all %}
                    {% if c.trimestre.id == trimestre_choice.id %}
                    <td class='text-center'>{% if c.prova is not None %}{{ c.prova}} {% else %}0{% endif %}</td>
                    <td class='text-center'>{% if c.trabalho is not None  %}{{ c.trabalho }}{% else %}0{% endif %}</td>
                    <td class='text-center'>{% if c.participacao is not None %}{{ c.participacao }}{% else %}0{% endif %}</td>
                    <td class='text-center'>{% if c.tarefas is not None  %}{{ c.tarefas }}{% else %}0{% endif %}</td>
                    <td class='text-center {% if c.nota_final <= 4.99 %}text-danger {% else %}text-primary fw-bolder{% endif %}'><strong>{{ c.nota_final }}</strong></td>
                    <td class="ocultar">{{ c.anotacoes }}</td>   
                    {% endif %}
                  {% endfor %}
                  <td class="ocultar">
                    <a href="{% url 'modulo_professor:criaNotasComposicao' a.id grade.id trimestre_choice.id %}" class="btn btn-success btn-sm">add Notas</a>
                </td>  
              </tr>
            {% endfor %}          
          </tbody>
        </table>



  </div>
</div>
{% endif %}



{% endblock main %}